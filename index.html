<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Candy Cartel - Sweet Confections</title>
<style>
/* ==================== Reset & Base Styles ==================== */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
body {
  font-family: 'Arial', sans-serif;
  background: #fff8f0;
  color: #333;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  line-height: 1.6;
}
a {
  text-decoration: none;
  color: inherit;
}
h1, h2, h3, h4, h5, h6 {
  margin-bottom: 10px;
}
button {
  cursor: pointer;
  border: none;
  border-radius: 5px;
  background-color: #ff6f61;
  color: #fff;
  font-weight: bold;
  padding: 10px 20px;
  font-size: 1em;
  transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
}
button:hover {
  background-color: #e65b50;
  transform: scale(1.02);
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

/* ==================== Navbar ==================== */
.navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: linear-gradient(135deg, #ff6f61, #ff3b3b);
  padding: 10px 20px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  flex-wrap: wrap;
  position: relative;
  z-index: 999;
}
.logo-section {
  display: flex;
  align-items: center;
}
.logo-section img {
  height: 50px;
  width: 50px;
  margin-right: 10px;
  animation: bounce 2s infinite;
}
.store-name {
  font-family: 'Brush Script MT', cursive;
  font-size: 1.8em;
  color: #fff;
  font-weight: bold;
  letter-spacing: 2px;
}
.nav-buttons {
  display: flex;
  align-items: center;
  margin-top: 5px;
}
.nav-buttons a {
  padding: 8px 14px;
  margin: 0 8px;
  font-size: 1em;
  font-weight: bold;
  border-radius: 4px;
  background: transparent;
  transition: background 0.3s, transform 0.2s;
}
.nav-buttons a:hover {
  background: rgba(255,255,255,0.2);
  transform: translateY(-2px);
}
/* Cart Badge and Notification */
.cart-container {
  position: relative;
  margin-left: 15px;
}
#cart-btn {
  font-size: 1.8em;
  position: relative;
  display: flex;
  align-items: center;
}
#cart-count {
  position: absolute;
  top: -8px;
  right: -8px;
  background: #fff;
  color: #ff6f61;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  font-weight: bold;
  font-size: 0.8em;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  transition: all 0.3s;
}
#notification {
  position: absolute;
  top: 50px;
  right: 20px;
  background-color: #4BB543;
  color: #fff;
  padding: 12px 20px;
  border-radius: 8px;
  opacity: 0;
  transform: translateY(-10px);
  transition: opacity 0.4s, transform 0.4s;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  font-weight: bold;
  z-index: 1000;
}
#notification.show {
  opacity: 1;
  transform: translateY(0);
}
/* Main Content */
#content {
  flex: 1;
  padding: 20px;
  max-width: 1200px;
  margin: auto;
}
/* Footer Styles */
footer {
  background-color: #222;
  color: #eee;
  padding: 20px;
  text-align: center;
}
footer h3 {
  margin-bottom: 10px;
}
footer p {
  margin: 5px 0;
}
/* Page Titles */
.page-title {
  font-family: 'Brush Script MT', cursive;
  font-size: 2em;
  text-align: center;
  margin-bottom: 20px;
  color: #ff6f61;
  letter-spacing: 2px;
}
/* Product Grid */
.products-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 20px;
}
.product-card {
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 10px;
  transition: transform 0.3s, box-shadow 0.3s;
}
.product-card:hover {
  transform: scale(1.03);
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}
.product-image {
  width: 100%;
  height: 150px;
  object-fit: cover;
  border-radius: 4px;
}
.product-name {
  font-weight: bold;
  margin: 10px 0 5px 0;
  text-align: center;
}
.product-price {
  color: #555;
  margin-bottom: 10px;
}
.add-cart-btn {
  background-color: #ff6f61;
  padding: 8px 14px;
  border-radius: 4px;
  font-weight: bold;
  transition: background 0.3s, transform 0.2s;
}
.add-cart-btn:hover {
  background-color: #e65b50;
  transform: scale(1.02);
}
/* Cart Table Styles */
#cart-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}
#cart-table th, #cart-table td {
  padding: 12px;
  border: 1px solid #ddd;
  text-align: center;
}
#cart-table th {
  background-color: #f4f4f4;
}
.total-row {
  font-weight: bold;
  font-size: 1.2em;
}
#checkout-btn {
  display: block;
  margin: 30px auto;
  padding: 14px 28px;
  font-size: 1.2em;
  background-color: #ff6f61;
}
#checkout-btn:hover {
  background-color: #e65b50;
}
/* Review Section styles */
#review-section {
  max-width: 800px;
  margin: 40px auto;
  padding: 20px;
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}
#review-stars {
  display: flex;
  justify-content: center;
  margin-bottom: 15px;
}
.star {
  font-size: 2em;
  color: #ccc;
  margin: 0 8px;
  cursor: pointer;
  transition: color 0.3s;
}
.star.filled {
  color: gold;
}
#review-text {
  width: 100%;
  min-height: 80px;
  padding: 10px;
  border-radius: 4px;
  border: 1px solid #ccc;
  font-size: 1em;
  resize: vertical;
}
#review-submit {
  margin-top: 15px;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

/* Responsive adjustments */
@media(max-width: 768px) {
  .nav-buttons {
    flex-direction: column;
  }
  #review-section {
    margin: 20px;
  }
}

/* Animations */
@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

/* Notification banner styles (for JS) */
.notification-banner {
  position: fixed;
  top: 80px;
  right: 20px;
  background-color: #4BB543;
  color: #fff;
  padding: 14px 20px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  font-weight: bold;
  opacity: 0;
  transform: translateY(-20px);
  transition: opacity 0.5s, transform 0.5s;
  z-index: 1050;
}
.notification-banner.show {
  opacity: 1;
  transform: translateY(0);
}
.notification-banner.hide {
  opacity: 0;
  transform: translateY(-20px);
}
</style>
</head>
<body>

<!-- Navigation Bar -->
<header class="navbar">
  <div class="logo-section">
    <img src="https://images.unsplash.com/photo-1549924231-f129b911e442?ixlib=rb-4.0.4&auto=format&fit=crop&w=50&q=80" alt="Candy Logo"/>
    <span class="store-name">Candy Cartel</span>
  </div>
  <div class="nav-buttons">
    <a href="#" data-page="home">Home</a>
    <a href="#" data-page="lollies">Lollies</a>
    <a href="#" data-page="chocolates">Chocolates</a>
    <a href="#" data-page="drinks">Drinks</a>
    <a href="#" data-page="chips">Chips</a>
    <div class="cart-container">
      <button id="cart-button" aria-label="Cart">ðŸ›’</button>
      <div id="cart-count">0</div>
    </div>
  </div>
</header>

<!-- Main Content -->
<div id="content"></div>

<!-- Scripts -->
<script>
// =================== JavaScript ===================

/* ----- Global Variables ----- */
const pages = ['home', 'lollies', 'chocolates', 'drinks', 'chips', 'cart', 'checkout', 'contact'];
let currentPage = 'home';

let cart = JSON.parse(localStorage.getItem('cart')) || [];
const MAX_CART_ITEMS = 999;

let reviews = JSON.parse(localStorage.getItem('reviews')) || [];

/* ----- Utility Functions ----- */

// Show notification near navbar
function showNotification(message) {
  const notif = document.createElement('div');
  notif.className = 'notification-banner show';
  notif.innerText = message;
  document.body.appendChild(notif);
  setTimeout(() => {
    notif.className = 'notification-banner hide';
    setTimeout(() => {
      notif.remove();
    }, 500);
  }, 2500);
}

// Update cart item count badge
function updateCartBadge() {
  const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
  document.getElementById('cart-count').innerText = totalItems;
}

// Save cart to local storage
function saveCart() {
  localStorage.setItem('cart', JSON.stringify(cart));
}

// Load cart from local storage
function loadCart() {
  const stored = localStorage.getItem('cart');
  if (stored) {
    cart = JSON.parse(stored);
  }
}

/* ----- Page Rendering Functions ----- */

// Render pages based on current state
function renderPage(page) {
  currentPage = page;
  document.getElementById('content').innerHTML = '';
  if (page === 'home') {
    renderHomePage();
  } else if (page === 'lollies') {
    renderProductsPage('Lollies', generateProducts('Lollies'));
  } else if (page === 'chocolates') {
    renderProductsPage('Chocolates', generateProducts('Chocolates'));
  } else if (page === 'drinks') {
    renderProductsPage('Drinks', generateProducts('Drinks'));
  } else if (page === 'chips') {
    renderProductsPage('Chips', generateProducts('Chips'));
  } else if (page === 'cart') {
    renderCartPage();
  } else if (page === 'checkout') {
    renderCheckoutPage();
  } else if (page === 'contact') {
    renderContactPage();
  }
}

/* ----- Generate Product Data with Names ----- */

function generateProducts(type) {
  const productNames = {
    'Lollies': ['Rainbow Swirl', 'Strawberry Bliss', 'Gummy Bears', 'Lemon Zest', 'Cherry Pop', 'Fruit Chews', 'Sour Worms', 'Candy Cane'],
    'Chocolates': ['Milk Chocolate Bar', 'Dark Chocolate Truffle', 'Caramel Fudge', 'White Chocolate Mousse', 'Almond Chocolate', 'Hazelnut Kisses', 'Chocolate Bites', 'Cocoa Dreams'],
    'Drinks': ['Cola Classic', 'Lemonade Spark', 'Strawberry Shake', 'Mint Mojito', 'Fruit Punch', 'Cream Soda', 'Iced Tea', 'Grape Fizz'],
    'Chips': ['Salt & Vinegar', 'BBQ Ribs', 'Cheddar Crisps', 'Spicy JalapeÃ±o', 'Sweet Potato', 'Classic Potato', 'Sour Cream & Onion', 'BBQ Blaze']
  };
  const names = productNames[type] || [`${type} ${Math.ceil(Math.random()*100)}`];

  return names.map((name, index) => ({
    id: `${type.toLowerCase()}_${index}`,
    name,
    price: (Math.random() * 4 + 1).toFixed(2),
    image: `https://via.placeholder.com/200x150?text=${encodeURIComponent(name)}`
  }));
}

/* ----- Home Page Rendering ----- */
function renderHomePage() {
  const container = document.getElementById('content');

  // Welcome message
  const header = document.createElement('h1');
  header.innerText = 'Welcome to Candy Cartel!';
  header.style.textAlign = 'center';
  header.style.marginBottom = '20px';
  header.style.fontFamily = "'Brush Script MT', cursive";
  header.style.color = '#ff6f61';
  container.appendChild(header);

  // Google Map
  const mapDiv = document.createElement('div');
  mapDiv.id = 'map';
  mapDiv.style.width = '100%';
  mapDiv.style.height = '400px';
  mapDiv.style.borderRadius = '8px';
  mapDiv.style.overflow = 'hidden';
  container.appendChild(mapDiv);
  setTimeout(initMap, 100);

  // Contact info block
  const contactInfo = document.createElement('div');
  contactInfo.style.display = 'flex';
  contactInfo.style.justifyContent = 'space-around';
  contactInfo.style.marginTop = '30px';

  const contactDetails = [
    { title: 'Phone', info: '+1 234 567 8901' },
    { title: 'Email', info: 'info@candycartel.com' },
    { title: 'Address', info: '456 Candy Street, Sweet City' }
  ];

  contactDetails.forEach(c => {
    const box = document.createElement('div');
    box.style.background = '#fff';
    box.style.padding = '15px';
    box.style.borderRadius = '8px';
    box.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
    box.style.minWidth = '200px';

    const title = document.createElement('h3');
    title.innerText = c.title;
    title.style.color = '#ff6f61';

    const info = document.createElement('p');
    info.innerText = c.info;

    box.appendChild(title);
    box.appendChild(info);
    contactInfo.appendChild(box);
  });
  container.appendChild(contactInfo);
}

/* ----- Product Pages with Names ----- */
function renderProductsPage(title, products) {
  const container = document.getElementById('content');
  const header = document.createElement('h2');
  header.className = 'page-title';
  header.innerText = title;
  container.appendChild(header);

  const grid = document.createElement('div');
  grid.className = 'products-grid';

  products.forEach(product => {
    const card = document.createElement('div');
    card.className = 'product-card';

    const img = document.createElement('img');
    img.src = product.image;
    img.className = 'product-image';

    const nameDiv = document.createElement('div');
    nameDiv.className = 'product-name';
    nameDiv.innerText = product.name;

    const priceDiv = document.createElement('div');
    priceDiv.className = 'product-price';
    priceDiv.innerText = `$${product.price}`;

    const btn = document.createElement('button');
    btn.className = 'add-cart-btn';
    btn.innerText = 'Add to Cart';
    btn.onclick = () => {
      addToCart({ id: product.id, name: product.name, price: parseFloat(product.price), quantity: 1 });
    };

    card.appendChild(img);
    card.appendChild(nameDiv);
    card.appendChild(priceDiv);
    card.appendChild(btn);
    grid.appendChild(card);
  });

  document.getElementById('content').appendChild(grid);
}

/* ----- Cart Page ----- */
function renderCartPage() {
  const container = document.getElementById('content');
  container.innerHTML = '';

  const header = document.createElement('h2');
  header.className = 'page-title';
  header.innerText = 'Your Shopping Cart';
  container.appendChild(header);

  if (cart.length === 0) {
    const emptyMsg = document.createElement('p');
    emptyMsg.innerText = 'Your cart is empty!';
    emptyMsg.style.textAlign = 'center';
    emptyMsg.style.fontSize = '1.2em';
    container.appendChild(emptyMsg);
    return;
  }

  // Table for cart items
  const table = document.createElement('table');
  table.id = 'cart-table';

  const headerRow = document.createElement('tr');
  ['Item', 'Price', 'Quantity', 'Total', 'Remove'].forEach(t => {
    const th = document.createElement('th');
    th.innerText = t;
    headerRow.appendChild(th);
  });
  table.appendChild(headerRow);

  let totalSum = 0;
  cart.forEach((item, index) => {
    const row = document.createElement('tr');

    // Item name
    const itemTd = document.createElement('td');
    itemTd.innerText = item.name;

    // Price
    const priceTd = document.createElement('td');
    priceTd.innerText = `$${item.price}`;

    // Quantity
    const qtyTd = document.createElement('td');
    const qtyInput = document.createElement('input');
    qtyInput.type = 'number';
    qtyInput.min = 1;
    qtyInput.max = MAX_CART_ITEMS;
    qtyInput.value = item.quantity;
    qtyInput.style.width = '60px';
    qtyInput.onchange = () => {
      const newQty = parseInt(qtyInput.value);
      if (isNaN(newQty) || newQty < 1) {
        qtyInput.value = item.quantity;
        return;
      }
      item.quantity = newQty;
      saveCart();
      updateCartBadge();
      renderCartPage();
    };
    qtyTd.appendChild(qtyInput);

    // Total
    const totalTd = document.createElement('td');
    const totalPrice = (item.price * item.quantity);
    totalTd.innerText = `$${totalPrice.toFixed(2)}`;
    totalSum += totalPrice;

    // Remove button
    const removeTd = document.createElement('td');
    const remBtn = document.createElement('button');
    remBtn.innerText = 'Remove';
    remBtn.onclick = () => {
      cart.splice(index, 1);
      saveCart();
      updateCartBadge();
      renderCartPage();
    };
    removeTd.appendChild(remBtn);

    row.appendChild(itemTd);
    row.appendChild(priceTd);
    row.appendChild(qtyTd);
    row.appendChild(totalTd);
    row.appendChild(removeTd);
    table.appendChild(row);
  });

  // Total sum row
  const totalRow = document.createElement('tr');
  totalRow.className = 'total-row';

  const totalLabelTd = document.createElement('td');
  totalLabelTd.colSpan = 3;
  totalLabelTd.innerText = 'Total';

  const totalPriceTd = document.createElement('td');
  totalPriceTd.innerText = `$${cart.reduce((sum, i) => sum + i.price * i.quantity, 0).toFixed(2)}`;

  const emptyTd = document.createElement('td');

  totalRow.appendChild(totalLabelTd);
  totalRow.appendChild(totalPriceTd);
  totalRow.appendChild(emptyTd);
  table.appendChild(totalRow);

  container.appendChild(table);

  // Checkout Button
  const checkoutBtn = document.createElement('button');
  checkoutBtn.id = 'checkout-btn';
  checkoutBtn.innerText = 'Proceed to Checkout';
  checkoutBtn.onclick = () => { renderPage('checkout'); };
  container.appendChild(checkoutBtn);
}

/* ----- Checkout Page ----- */
function renderCheckoutPage() {
  const container = document.getElementById('content');
  container.innerHTML = '';

  const header = document.createElement('h2');
  header.className = 'page-title';
  header.innerText = 'Checkout';
  container.appendChild(header);

  if (cart.length === 0) {
    const msg = document.createElement('p');
    msg.innerText = 'Your cart is empty!';
    msg.style.textAlign = 'center';
    msg.style.fontSize = '1.2em';
    container.appendChild(msg);
    return;
  }

  // Cart Summary
  const summaryDiv = document.createElement('div');
  summaryDiv.style.maxWidth = '600px';
  summaryDiv.style.margin = '0 auto';

  const list = document.createElement('ul');
  list.style.listStyle = 'none';
  list.style.padding = '0';

  let totalAmount = 0;
  cart.forEach(item => {
    const li = document.createElement('li');
    li.innerText = `${item.name} x ${item.quantity} = $${(item.price * item.quantity).toFixed(2)}`;
    list.appendChild(li);
    totalAmount += item.price * item.quantity;
  });
  summaryDiv.appendChild(list);

  const totalP = document.createElement('p');
  totalP.style.fontSize = '1.4em';
  totalP.style.fontWeight = 'bold';
  totalP.innerText = `Total: $${totalAmount.toFixed(2)}`;
  summaryDiv.appendChild(totalP);

  // Payment info form
  const form = document.createElement('form');
  form.style.marginTop = '20px';

  const nameLabel = document.createElement('label');
  nameLabel.innerText = 'Name:';
  const nameInput = document.createElement('input');
  nameInput.type = 'text';
  nameInput.required = true;

  const emailLabel = document.createElement('label');
  emailLabel.innerText = 'Email:';
  const emailInput = document.createElement('input');
  emailInput.type = 'email';
  emailInput.required = true;

  const addressLabel = document.createElement('label');
  addressLabel.innerText = 'Address:';
  const addressInput = document.createElement('input');
  addressInput.type = 'text';
  addressInput.required = true;

  const payBtn = document.createElement('button');
  payBtn.type = 'submit';
  payBtn.innerText = 'Pay Now';

  form.appendChild(nameLabel);
  form.appendChild(nameInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(emailLabel);
  form.appendChild(emailInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(addressLabel);
  form.appendChild(addressInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(payBtn);

  form.onsubmit = (e) => {
    e.preventDefault();
    alert('Thank you for your purchase!');
    cart = [];
    saveCart();
    updateCartBadge();
    renderPage('home');
  };

  summaryDiv.appendChild(form);
  container.appendChild(summaryDiv);
}

/* ----- Contact Page & Review System ----- */
function renderContactPage() {
  const container = document.getElementById('content');
  container.innerHTML = '';

  const header = document.createElement('h2');
  header.className = 'page-title';
  header.innerText = 'Contact & Review';
  container.appendChild(header);

  // Contact Form
  const form = document.createElement('form');
  form.style.maxWidth = '600px';
  form.style.margin = '20px auto';

  const nameLabel = document.createElement('label');
  nameLabel.innerText = 'Name:';
  const nameInput = document.createElement('input');
  nameInput.type = 'text';
  nameInput.required = true;

  const emailLabel = document.createElement('label');
  emailLabel.innerText = 'Email:';
  const emailInput = document.createElement('input');
  emailInput.type = 'email';
  emailInput.required = true;

  const messageLabel = document.createElement('label');
  messageLabel.innerText = 'Message:';
  const messageInput = document.createElement('textarea');
  messageInput.required = true;

  const submitBtn = document.createElement('button');
  submitBtn.type = 'submit';
  submitBtn.innerText = 'Send Message';

  form.appendChild(nameLabel);
  form.appendChild(nameInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(emailLabel);
  form.appendChild(emailInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(messageLabel);
  form.appendChild(messageInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(submitBtn);

  form.onsubmit = (e) => {
    e.preventDefault();
    alert('Your message has been sent!');
    form.reset();
  };

  container.appendChild(form);

  // Review Section
  const reviewDiv = document.createElement('div');
  reviewDiv.id = 'review-section';

  const reviewHeader = document.createElement('h3');
  reviewHeader.innerText = 'Leave a Review';
  reviewHeader.style.textAlign = 'center';
  reviewDiv.appendChild(reviewHeader);

  // Star Rating
  const starContainer = document.createElement('div');
  starContainer.id = 'review-stars';

  let selectedStars = 0;
  const starsArray = [];
  for (let i=1; i<=5; i++) {
    const star = document.createElement('span');
    star.className = 'star';
    star.innerHTML = '&#9733;';
    star.dataset.value = i;
    star.onclick = () => {
      selectedStars = i;
      updateStarDisplay();
    };
    starsArray.push(star);
    starContainer.appendChild(star);
  }

  function updateStarDisplay() {
    starsArray.forEach((s, index) => {
      s.className = 'star' + ((index + 1) <= selectedStars ? ' filled' : '');
    });
  }

  reviewDiv.appendChild(starContainer);

  // Review Textarea
  const reviewTextArea = document.createElement('textarea');
  reviewTextArea.id = 'review-text';
  reviewTextArea.placeholder = 'Write your review here...';

  reviewDiv.appendChild(reviewTextArea);

  // Submit button for review
  const reviewBtn = document.createElement('button');
  reviewBtn.id = 'review-submit';
  reviewBtn.innerText = 'Submit Review';

  reviewBtn.onclick = () => {
    if (selectedStars === 0 || reviewTextArea.value.trim() === '') {
      alert('Please select stars and write a review!');
      return;
    }
    // Save review
    reviews.push({
      stars: selectedStars,
      text: reviewTextArea.value.trim(),
      date: new Date().toISOString()
    });
    localStorage.setItem('reviews', JSON.stringify(reviews));
    alert('Thank you for your review!');
    selectedStars = 0;
    updateStarDisplay();
    reviewTextArea.value = '';
    renderReviews();
  };

  reviewDiv.appendChild(reviewBtn);
  container.appendChild(reviewDiv);
  renderReviews();

  // Render reviews list
  function renderReviews() {
    let existing = document.getElementById('reviews-list');
    if (existing) existing.remove();

    const listDiv = document.createElement('div');
    listDiv.id = 'reviews-list';

    if (reviews.length === 0) {
      const noRev = document.createElement('p');
      noRev.innerText = 'No reviews yet.';
      noRev.style.textAlign = 'center';
      listDiv.appendChild(noRev);
    } else {
      reviews.slice().reverse().forEach(r => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'review-item';

        const headerDiv = document.createElement('div');
        headerDiv.className = 'review-header';

        const starsSpan = document.createElement('span');
        starsSpan.className = 'review-stars';
        starsSpan.innerHTML = '&#9733;'.repeat(r.stars) + '&#9734;'.repeat(5 - r.stars);

        const dateSpan = document.createElement('span');
        dateSpan.className = 'review-date';
        dateSpan.innerText = new Date(r.date).toLocaleString();

        headerDiv.appendChild(starsSpan);
        headerDiv.appendChild(dateSpan);

        const reviewTextP = document.createElement('p');
        reviewTextP.innerText = r.text;

        itemDiv.appendChild(headerDiv);
        itemDiv.appendChild(reviewTextP);
        listDiv.appendChild(itemDiv);
      });
    }
    document.getElementById('review-section').appendChild(listDiv);
  }
}

/* ----- Event Listeners ----- */
document.querySelectorAll('.nav-buttons a').forEach(link => {
  link.onclick = (e) => {
    e.preventDefault();
    const page = e.target.dataset.page;
    if (pages.includes(page)) {
      renderPage(page);
    }
  };
});
document.getElementById('cart-button').onclick = () => {
  renderPage('cart');
};

/* ----- Add to Cart Function ----- */
function addToCart(item) {
  const existing = cart.find(i => i.id === item.id);
  if (existing) {
    existing.quantity += 1;
  } else {
    if (cart.reduce((sum, i) => sum + i.quantity, 0) >= MAX_CART_ITEMS) {
      alert('Cart limit reached!');
      return;
    }
    item.quantity = 1;
    cart.push(item);
  }
  saveCart();
  updateCartBadge();
  showNotification(`Added ${item.name} to cart`);
}

/* ----- Render Cart Page ----- */
function renderCartPage() {
  const container = document.getElementById('content');
  container.innerHTML = '';

  const header = document.createElement('h2');
  header.className = 'page-title';
  header.innerText = 'Your Shopping Cart';
  container.appendChild(header);

  if (cart.length === 0) {
    const emptyMsg = document.createElement('p');
    emptyMsg.innerText = 'Your cart is empty!';
    emptyMsg.style.textAlign = 'center';
    emptyMsg.style.fontSize = '1.2em';
    container.appendChild(emptyMsg);
    return;
  }

  // Table for cart items
  const table = document.createElement('table');
  table.id = 'cart-table';

  const headerRow = document.createElement('tr');
  ['Item', 'Price', 'Quantity', 'Total', 'Remove'].forEach(t => {
    const th = document.createElement('th');
    th.innerText = t;
    headerRow.appendChild(th);
  });
  table.appendChild(headerRow);

  let totalSum = 0;
  cart.forEach((item, index) => {
    const row = document.createElement('tr');

    // Item name
    const itemTd = document.createElement('td');
    itemTd.innerText = item.name;

    // Price
    const priceTd = document.createElement('td');
    priceTd.innerText = `$${item.price}`;

    // Quantity
    const qtyTd = document.createElement('td');
    const qtyInput = document.createElement('input');
    qtyInput.type = 'number';
    qtyInput.min = 1;
    qtyInput.max = MAX_CART_ITEMS;
    qtyInput.value = item.quantity;
    qtyInput.style.width = '60px';
    qtyInput.onchange = () => {
      const newQ = parseInt(qtyInput.value);
      if (isNaN(newQ) || newQ < 1) {
        qtyInput.value = item.quantity;
        return;
      }
      item.quantity = newQ;
      saveCart();
      updateCartBadge();
      renderCartPage();
    };
    qtyTd.appendChild(qtyInput);

    // Total for item
    const totalTd = document.createElement('td');
    const totalPrice = (item.price * item.quantity);
    totalTd.innerText = `$${totalPrice.toFixed(2)}`;
    totalSum += totalPrice;

    // Remove button
    const removeTd = document.createElement('td');
    const remBtn = document.createElement('button');
    remBtn.innerText = 'Remove';
    remBtn.onclick = () => {
      cart.splice(index, 1);
      saveCart();
      updateCartBadge();
      renderCartPage();
    };
    removeTd.appendChild(remBtn);

    row.appendChild(itemTd);
    row.appendChild(priceTd);
    row.appendChild(qtyTd);
    row.appendChild(totalTd);
    row.appendChild(removeTd);
    table.appendChild(row);
  });

  // Total row
  const totalRow = document.createElement('tr');
  totalRow.className = 'total-row';

  const totalLabelTd = document.createElement('td');
  totalLabelTd.colSpan = 3;
  totalLabelTd.innerText = 'Total';

  const totalPriceTd = document.createElement('td');
  totalPriceTd.innerText = `$${cart.reduce((sum, i) => sum + i.price * i.quantity, 0).toFixed(2)}`;

  const emptyTd = document.createElement('td');

  totalRow.appendChild(totalLabelTd);
  totalRow.appendChild(totalPriceTd);
  totalRow.appendChild(emptyTd);
  table.appendChild(totalRow);

  container.appendChild(table);

  const checkoutBtn = document.createElement('button');
  checkoutBtn.id = 'checkout-btn';
  checkoutBtn.innerText = 'Proceed to Checkout';
  checkoutBtn.onclick = () => { renderPage('checkout'); };
  container.appendChild(checkoutBtn);
}

/* ----- Checkout Page ----- */
function renderCheckoutPage() {
  const container = document.getElementById('content');
  container.innerHTML = '';

  const header = document.createElement('h2');
  header.className = 'page-title';
  header.innerText = 'Checkout';
  container.appendChild(header);

  if (cart.length === 0) {
    const msg = document.createElement('p');
    msg.innerText = 'Your cart is empty!';
    msg.style.textAlign = 'center';
    msg.style.fontSize = '1.2em';
    container.appendChild(msg);
    return;
  }

  const summaryDiv = document.createElement('div');
  summaryDiv.style.maxWidth = '600px';
  summaryDiv.style.margin = '0 auto';

  const list = document.createElement('ul');
  list.style.listStyle = 'none';
  list.style.padding = '0';

  let totalAmount = 0;
  cart.forEach(item => {
    const li = document.createElement('li');
    li.innerText = `${item.name} x ${item.quantity} = $${(item.price * item.quantity).toFixed(2)}`;
    list.appendChild(li);
    totalAmount += item.price * item.quantity;
  });
  summaryDiv.appendChild(list);

  const totalP = document.createElement('p');
  totalP.style.fontSize = '1.4em';
  totalP.style.fontWeight = 'bold';
  totalP.innerText = `Total: $${totalAmount.toFixed(2)}`;
  summaryDiv.appendChild(totalP);

  // Payment form
  const form = document.createElement('form');
  form.style.marginTop = '20px';

  const nameLabel = document.createElement('label');
  nameLabel.innerText = 'Name:';
  const nameInput = document.createElement('input');
  nameInput.type = 'text';
  nameInput.required = true;

  const emailLabel = document.createElement('label');
  emailLabel.innerText = 'Email:';
  const emailInput = document.createElement('input');
  emailInput.type = 'email';
  emailInput.required = true;

  const addressLabel = document.createElement('label');
  addressLabel.innerText = 'Address:';
  const addressInput = document.createElement('input');
  addressInput.type = 'text';
  addressInput.required = true;

  const payBtn = document.createElement('button');
  payBtn.type = 'submit';
  payBtn.innerText = 'Pay Now';

  form.appendChild(nameLabel);
  form.appendChild(nameInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(emailLabel);
  form.appendChild(emailInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(addressLabel);
  form.appendChild(addressInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(payBtn);

  form.onsubmit = (e) => {
    e.preventDefault();
    alert('Thank you for your purchase!');
    cart = [];
    saveCart();
    updateCartBadge();
    renderPage('home');
  };

  summaryDiv.appendChild(form);
  container.appendChild(summaryDiv);
}

/* ----- Contact & Review Part ----- */
function renderContactPage() {
  const container = document.getElementById('content');
  container.innerHTML = '';

  const header = document.createElement('h2');
  header.className = 'page-title';
  header.innerText = 'Contact & Review';
  container.appendChild(header);

  // Contact form
  const form = document.createElement('form');
  form.style.maxWidth = '600px';
  form.style.margin = '20px auto';

  const nameLabel = document.createElement('label');
  nameLabel.innerText = 'Name:';
  const nameInput = document.createElement('input');
  nameInput.type = 'text';
  nameInput.required = true;

  const emailLabel = document.createElement('label');
  emailLabel.innerText = 'Email:';
  const emailInput = document.createElement('input');
  emailInput.type = 'email';
  emailInput.required = true;

  const messageLabel = document.createElement('label');
  messageLabel.innerText = 'Message:';
  const messageInput = document.createElement('textarea');
  messageInput.required = true;

  const submitBtn = document.createElement('button');
  submitBtn.type = 'submit';
  submitBtn.innerText = 'Send Message';

  form.appendChild(nameLabel);
  form.appendChild(nameInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(emailLabel);
  form.appendChild(emailInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(messageLabel);
  form.appendChild(messageInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(submitBtn);

  form.onsubmit = (e) => {
    e.preventDefault();
    alert('Your message has been sent!');
    form.reset();
  };

  container.appendChild(form);

  // Review section
  const reviewDiv = document.createElement('div');
  reviewDiv.id = 'review-section';

  const reviewHeader = document.createElement('h3');
  reviewHeader.innerText = 'Leave a Review';
  reviewHeader.style.textAlign = 'center';
  reviewDiv.appendChild(reviewHeader);

  // Star rating
  const starContainer = document.createElement('div');
  starContainer.id = 'review-stars';

  let selectedStars = 0;
  const starsArray = [];
  for (let i=1; i<=5; i++) {
    const starSpan = document.createElement('span');
    starSpan.className = 'star';
    starSpan.innerHTML = '&#9733;';
    starSpan.dataset.value = i;
    starSpan.onclick = () => {
      selectedStars = i;
      updateStarDisplay();
    };
    starsArray.push(starSpan);
    starContainer.appendChild(starSpan);
  }

  function updateStarDisplay() {
    starsArray.forEach((s, index) => {
      s.className = 'star' + ((index + 1) <= selectedStars ? ' filled' : '');
    });
  }

  // Review textarea
  const reviewText = document.createElement('textarea');
  reviewText.id = 'review-text';
  reviewText.placeholder = 'Write your review here...';

  // Submit review button
  const reviewBtn = document.createElement('button');
  reviewBtn.id = 'review-submit';
  reviewBtn.innerText = 'Submit Review';

  reviewBtn.onclick = () => {
    if (selectedStars === 0 || reviewText.value.trim() === '') {
      alert('Please select stars and write a review!');
      return;
    }
    reviews.push({
      stars: selectedStars,
      text: reviewText.value.trim(),
      date: new Date().toISOString()
    });
    localStorage.setItem('reviews', JSON.stringify(reviews));
    alert('Thank you for your review!');
    selectedStars = 0;
    updateStarDisplay();
    reviewText.value = '';
    renderReviews();
  };

  reviewDiv.appendChild(reviewBtn);
  container.appendChild(reviewDiv);
  renderReviews();

  // Render reviews list
  function renderReviews() {
    let existing = document.getElementById('reviews-list');
    if (existing) existing.remove();

    const listDiv = document.createElement('div');
    listDiv.id = 'reviews-list';

    if (reviews.length === 0) {
      const noRev = document.createElement('p');
      noRev.innerText = 'No reviews yet.';
      noRev.style.textAlign = 'center';
      listDiv.appendChild(noRev);
    } else {
      reviews.slice().reverse().forEach(r => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'review-item';

        const headerDiv = document.createElement('div');
        headerDiv.className = 'review-header';

        const starsSpan = document.createElement('span');
        starsSpan.className = 'review-stars';
        starsSpan.innerHTML = '&#9733;'.repeat(r.stars) + '&#9734;'.repeat(5 - r.stars);

        const dateSpan = document.createElement('span');
        dateSpan.className = 'review-date';
        dateSpan.innerText = new Date(r.date).toLocaleString();

        headerDiv.appendChild(starsSpan);
        headerDiv.appendChild(dateSpan);

        const reviewTextP = document.createElement('p');
        reviewTextP.innerText = r.text;

        itemDiv.appendChild(headerDiv);
        itemDiv.appendChild(reviewTextP);
        listDiv.appendChild(itemDiv);
      });
    }
    document.getElementById('review-section').appendChild(listDiv);
  }
}

/* ----- Event Listeners for Navigation ----- */
document.querySelectorAll('.nav-buttons a').forEach(link => {
  link.onclick = (e) => {
    e.preventDefault();
    const page = e.target.dataset.page;
    if (pages.includes(page)) {
      renderPage(page);
    }
  };
});
document.getElementById('cart-button').onclick = () => {
  renderPage('cart');
};

/* ----- Initialize on Load ----- */
window.onload = () => {
  loadCart();
  updateCartBadge();
  renderPage('home');
};

// ----- Google Map Initialization -----
function initMap() {
  const mapDiv = document.getElementById('map');
  if (!mapDiv) return;
  const map = new google.maps.Map(mapDiv, {
    center: { lat: 40.7128, lng: -74.0060 },
    zoom: 12
  });
  new google.maps.Marker({ position: { lat: 40.7128, lng: -74.0060 }, map: map });
}

</script>
<!-- Load Google Maps API -->
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY"></script>
</body>
</html>
